# Обновление: Сохранение текстовых ответов

## Проблема

При прохождении теста с открытыми вопросами (где пользователь вводит текст), введенный ответ не сохранялся и не отображался в истории результатов.

## Решение

### 1. Серверная часть (Backend)

**Файл: `server/models/Result.js`**

Изменено поле `answers` с типа `[Number]` на `[mongoose.Schema.Types.Mixed]`:

```javascript
// ДО:
answers: [Number],

// ПОСЛЕ:
answers: [mongoose.Schema.Types.Mixed], // Поддержка как чисел, так и строк
```

Это позволяет сохранять в массиве `answers` как числовые индексы (для множественного выбора), так и текстовые строки (для открытых вопросов).

### 2. Клиентская часть (Frontend)

**Файл: `client/src/pages/MyHistory/index.tsx`**

Обновлены типы TypeScript для поддержки смешанных ответов:

```typescript
// Добавлен тип Answer
type Answer = number | string;

// Обновлен интерфейс ResultDetail
interface ResultDetail extends Result {
  answers: Answer[]; // Было: number[]
  correctAnswers: number[];
  shuffledQuestions: Question[];
}
```

## Результат

✅ **Теперь работает:**

- Текстовые ответы пользователя сохраняются в базе данных
- В разделе "Мои результаты" отображается именно то, что ввел пользователь
- Правильно показываются ошибки для открытых вопросов
- Отображается правильный ответ, если пользователь ответил неправильно

## Пример данных в базе

```javascript
{
  "answers": [
    "Москва",        // открытый вопрос - сохраняется строка
    2,               // множественный выбор - сохраняется индекс
    "париж",         // открытый вопрос - сохраняется как ввел пользователь
    1                // множественный выбор - индекс
  ],
  // ... остальные поля
}
```

## Требуется ли миграция?

**НЕТ.** Изменения полностью обратно совместимы:

- Старые результаты с числовыми массивами продолжат работать
- Новые результаты будут сохранять текстовые ответы где нужно
- MongoDB автоматически поддерживает Mixed типы

## Перезапуск сервера

После изменения модели перезапустите сервер:

```bash
cd server
npm start
# или
node index.js
```

Клиентская часть обновится автоматически при сохранении файлов (если используется Vite dev server).
